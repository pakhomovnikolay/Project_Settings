<Window x:Class="Project_Settings.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:l="clr-namespace:Project_Settings"
        xmlns:vm="clr-namespace:Project_Settings.ViewModels"
        Title="{Binding Path=MyTitle}"
        Background="{DynamicResource ResultBackground}"
        Foreground="{DynamicResource ResultForeground}"
        Height="auto" Width="auto" MinHeight="400" MinWidth="800"
        WindowState="Maximized" WindowStartupLocation="CenterScreen"
        Closing="Window_Closing">

    <Window.DataContext>
        <vm:MainWindowsViewModel/>
    </Window.DataContext>

    <DockPanel>

        <!-- ===================================================== Меню ===================================================== -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="Файл">
                <MenuItem Header="Создать"/>
                <MenuItem Header="Открыть"/>
                <MenuItem Header="Сохранить" Command="{Binding Path=CmdSaveProject}"/>
                <MenuItem Header="Сохранить как"/>
                <MenuItem Header="Настройки"/>
                <MenuItem Header="Добавить строку" Command="{Binding Path=CmdAddRow}"/>
            </MenuItem>
            <MenuItem Header="Надстройки">
            </MenuItem>

            <MenuItem Header="Формат">
            </MenuItem>

            <CheckBox x:Name="CBoxBlackTheames"
                  Content="Установить темную тему"
                  Width="200" Height="15" IsEnabled="{Binding flWhiteTheames}"
                  IsThreeState="False"
                  Foreground="{Binding Path=ResultMenuItemForeground}"
                  IsChecked="{Binding flBlackTheames}"
                  Command="{Binding CmdSetBlackTheames}"/>

            <CheckBox x:Name="CBoxWhiteTheames"
                  Content="Установить светлую тему"
                  Width="200" Height="15" IsEnabled="{Binding flBlackTheames}"
                  IsThreeState="False"
                  Foreground="{Binding Path=ResultMenuItemForeground}"
                  IsChecked="{Binding flWhiteTheames}"
                  Command="{Binding CmdSetWhiteTheames}"/>
        </Menu>

        <!-- ===================================================== Панель инструментов ===================================================== -->
        <ToolBarPanel DockPanel.Dock="Bottom" Height="30">
            <DockPanel>
                <TextBlock DockPanel.Dock="Left" Text="{Binding MyVersion}" Margin="5,0,0,0"/>
            </DockPanel>
        </ToolBarPanel>

        <!-- ===================================================== Данные ===================================================== -->
        <Grid DockPanel.Dock="Left">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <GroupBox Header="Список листов" Grid.Column="0" BorderBrush="{DynamicResource ResultBorderBrush}">
                <ListBox ItemsSource="{Binding Path=MyDataGridItems}" SelectedItem="{Binding Path=SelectedSheets}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Path=Name}"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </GroupBox>
            <GroupBox Grid.Column="1" BorderBrush="{DynamicResource ResultBorderBrush}">
                <GroupBox.Header>
                    <TextBlock Text="{Binding Path=SelectedSheets.Name, StringFormat=Выбраный лист - {0}, FallbackValue='Данные листа', TargetNullValue='Группа не выбрана'}"/>
                </GroupBox.Header>
                <DataGrid x:Name="MyDataGrid" IsReadOnly="False"
                    BorderBrush="{DynamicResource ResultBorderBrush}"
                    ItemsSource="{Binding Path=SelectedSheets.DataTables}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="A" MinWidth="50"/>
                        <DataGridTextColumn Header="B" MinWidth="50"/>
                        <DataGridTextColumn Header="C" MinWidth="50"/>
                        <DataGridTextColumn Header="D" MinWidth="50"/>
                        <DataGridTextColumn Header="E" MinWidth="50"/>
                        <DataGridTextColumn Header="F" MinWidth="50"/>
                        <DataGridTextColumn Header="G" MinWidth="50"/>
                        <DataGridTextColumn Header="H" MinWidth="50"/>
                        <DataGridTextColumn Header="I" MinWidth="50"/>
                        <DataGridTextColumn Header="J" MinWidth="50"/>
                        <DataGridTextColumn Header="K" MinWidth="50"/>
                        <DataGridTextColumn Header="L" MinWidth="50"/>
                        <DataGridTextColumn Header="M" MinWidth="50"/>
                        <DataGridTextColumn Header="N" MinWidth="50"/>
                        <DataGridTextColumn Header="O" MinWidth="50"/>
                        <DataGridTextColumn Header="P" MinWidth="50"/>
                        <DataGridTextColumn Header="Q" MinWidth="50"/>
                        <DataGridTextColumn Header="R" MinWidth="50"/>
                        <DataGridTextColumn Header="S" MinWidth="50"/>
                        <DataGridTextColumn Header="T" MinWidth="50"/>
                        <DataGridTextColumn Header="U" MinWidth="50"/>
                        <DataGridTextColumn Header="V" MinWidth="50"/>
                        <DataGridTextColumn Header="W" MinWidth="50"/>
                        <DataGridTextColumn Header="X" MinWidth="50"/>
                        <DataGridTextColumn Header="Y" MinWidth="50"/>
                        <DataGridTextColumn Header="Z" MinWidth="50"/>
                    </DataGrid.Columns>
                    <!--<DataGridTemplateColumn>
                        <DataGridTemplateColumn.HeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            </Style>
                        </DataGridTemplateColumn.HeaderStyle>
                    </DataGridTemplateColumn>-->
                    <!--<Style TargetType="DataGridColumnHeader">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                    </Style>-->
                </DataGrid>
            </GroupBox>
            
        </Grid>
    </DockPanel>
</Window>
